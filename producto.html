<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Producto seleccionado</title>
</head>
<body>
    <section class="contenedor">
        <header>
            <div class="carrusel">
                <div class="carrusel-imagenes" id="carrusel-imagenes"></div>
                <button class="carrusel-btn prev">&#10094;</button>
                <button class="carrusel-btn next">&#10095;</button>
            </div>
        </header>
        <section class="seccionProductoSleccionado">  
            <h2 class="productoSeleccionado" id="producto-nombre"></h2>
            <span class="descripcionProductoSeleccionado" id="producto-descripcion"></span>
            <h2 class="precioProductoSeleccionado" id="producto-precio"></h2>
        </section>
        <section class="botonesProductos">
            <button class="consultaProductoWhatsapp">Consultar por WhatsApp</button>
            <button class="seguirViendo">Seguir viendo</button>
        </section>
    </section>
    <script src="script.js"></script>
    <script>
    // Cargar datos del producto seleccionado y las imágenes del carrusel
    document.addEventListener('DOMContentLoaded', function () {
      const data = JSON.parse(localStorage.getItem('productoSeleccionado'));
      if (data) {
        document.getElementById('producto-nombre').textContent = data.nombre;
        document.getElementById('producto-descripcion').textContent = data.descripcion;
        document.getElementById('producto-precio').textContent = data.precio;
        // Cargar imágenes en el carrusel
        const carrusel = document.getElementById('carrusel-imagenes');
        carrusel.innerHTML = '';
        data.imagenes.forEach(src => {
          const img = document.createElement('img');
          img.src = src;
          img.alt = data.nombre;
          carrusel.appendChild(img);
        });
      }
    });
    </script>
    <script>
    // Botón WhatsApp: dos mensajes (uno con la imagen, otro con los datos)
    document.addEventListener('DOMContentLoaded', function () {
      const btnWhatsapp = document.querySelector('.consultaProductoWhatsapp');
      const numeroWhatsapp = '5492477316189'; // Cambia este número por el tuyo

      btnWhatsapp.addEventListener('click', function () {
        const data = JSON.parse(localStorage.getItem('productoSeleccionado'));
        if (!data) return;

        // Obtener la imagen activa del carrusel
        const carrusel = document.getElementById('carrusel-imagenes');
        const images = carrusel.querySelectorAll('img');
        let index = 0;
        const transform = carrusel.style.transform;
        if (transform) {
          const match = transform.match(/-([0-9]+)%/);
          if (match) {
            index = parseInt(match[1], 10) / 100;
          }
        }
        const imagenActiva = images[index] ? images[index].src : '';

        // Primer mensaje: solo la imagen (para vista previa)
        const urlImagen = `https://wa.me/${numeroWhatsapp}?text=${encodeURIComponent(imagenActiva)}`;
        window.open(urlImagen, '_blank');

        // Segundo mensaje: datos del producto
        let mensaje = `🛒 *Consulta de producto*\n\n`;
        mensaje += `*${data.nombre}*\n`;
        mensaje += `${data.descripcion}\n`;
        mensaje += `💲 *Precio:* ${data.precio}\n`;
        const urlDatos = `https://wa.me/${numeroWhatsapp}?text=${encodeURIComponent(mensaje)}`;
        setTimeout(() => {
          window.open(urlDatos, '_blank');
        }, 1000); // Espera 1 segundo para no saturar
      });
    });
    </script>
    <script>
    // Botón Seguir viendo
    document.addEventListener('DOMContentLoaded', function () {
      const btnSeguirViendo = document.querySelector('.seguirViendo');
      if (btnSeguirViendo) {
        btnSeguirViendo.addEventListener('click', function () {
          window.location.href = 'index.html';
        });
      }
    });
    </script>
</body>
</html>